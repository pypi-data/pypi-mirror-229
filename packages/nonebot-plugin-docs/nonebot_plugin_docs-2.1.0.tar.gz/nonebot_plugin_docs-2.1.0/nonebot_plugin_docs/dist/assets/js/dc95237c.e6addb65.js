"use strict";(self.webpackChunknonebot=self.webpackChunknonebot||[]).push([[1790],{35318:function(e,n,t){t.r(n),t.d(n,{MDXContext:function(){return i},MDXProvider:function(){return m},mdx:function(){return b},useMDXComponents:function(){return s},withMDXComponents:function(){return u}});var r=t(27378);function a(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function o(){return o=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},o.apply(this,arguments)}function l(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function d(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?l(Object(t),!0).forEach((function(n){a(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):l(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function p(e,n){if(null==e)return{};var t,r,a=function(e,n){if(null==e)return{};var t,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)t=o[r],n.indexOf(t)>=0||(a[t]=e[t]);return a}(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)t=o[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var i=r.createContext({}),u=function(e){return function(n){var t=s(n.components);return r.createElement(e,o({},n,{components:t}))}},s=function(e){var n=r.useContext(i),t=n;return e&&(t="function"==typeof e?e(n):d(d({},n),e)),t},m=function(e){var n=s(e.components);return r.createElement(i.Provider,{value:n},e.children)},c={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},f=r.forwardRef((function(e,n){var t=e.components,a=e.mdxType,o=e.originalType,l=e.parentName,i=p(e,["components","mdxType","originalType","parentName"]),u=s(t),m=a,f=u["".concat(l,".").concat(m)]||u[m]||c[m]||o;return t?r.createElement(f,d(d({ref:n},i),{},{components:t})):r.createElement(f,d({ref:n},i))}));function b(e,n){var t=arguments,a=n&&n.mdxType;if("string"==typeof e||a){var o=t.length,l=new Array(o);l[0]=f;var d={};for(var p in n)hasOwnProperty.call(n,p)&&(d[p]=n[p]);d.originalType=e,d.mdxType="string"==typeof e?e:a,l[1]=d;for(var i=2;i<o;i++)l[i]=t[i];return r.createElement.apply(null,l)}return r.createElement.apply(null,t)}f.displayName="MDXCreateElement"},85893:function(e,n,t){n.Z=void 0;var r,a=(r=t(27378))&&r.__esModule?r:{default:r};var o=function(e){var n=e.children,t=e.hidden,r=e.className;return a.default.createElement("div",{role:"tabpanel",hidden:t,className:r},n)};n.Z=o},88473:function(e,n,t){n.Z=void 0;var r=function(e,n){if(!n&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=i(n);if(t&&t.has(e))return t.get(e);var r={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var l=a?Object.getOwnPropertyDescriptor(e,o):null;l&&(l.get||l.set)?Object.defineProperty(r,o,l):r[o]=e[o]}r.default=e,t&&t.set(e,r);return r}(t(27378)),a=p(t(38944)),o=p(t(76457)),l=p(t(3009)),d=t(85940);function p(e){return e&&e.__esModule?e:{default:e}}function i(e){if("function"!=typeof WeakMap)return null;var n=new WeakMap,t=new WeakMap;return(i=function(e){return e?t:n})(e)}function u(){return u=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},u.apply(this,arguments)}function s(e){var n,t,o,p=e.lazy,i=e.defaultValue,u=e.values,s=e.groupId,m=e.className,c=r.Children.map(e.children,(function(e){if((0,r.isValidElement)(e)&&void 0!==e.props.value)return e;throw new Error("Docusaurus error: Bad <Tabs> child <"+("string"==typeof e.type?e.type:e.type.name)+'>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.')})),f=null!=u?u:c.map((function(e){var n=e.props;return{value:n.value,label:n.label}})),b=(0,d.duplicates)(f,(function(e,n){return e.value===n.value}));if(b.length>0)throw new Error('Docusaurus error: Duplicate values "'+b.map((function(e){return e.value})).join(", ")+'" found in <Tabs>. Every value needs to be unique.');var x=null===i?i:null!==(n=null!=i?i:null===(t=c.find((function(e){return e.props.default})))||void 0===t?void 0:t.props.value)&&void 0!==n?n:null===(o=c[0])||void 0===o?void 0:o.props.value;if(null!==x&&!f.some((function(e){return e.value===x})))throw new Error('Docusaurus error: The <Tabs> has a defaultValue "'+x+'" but none of its children has the corresponding value. Available values are: '+f.map((function(e){return e.value})).join(", ")+". If you intend to show no default tab, use defaultValue={null} instead.");var h=(0,l.default)(),v=h.tabGroupChoices,y=h.setTabGroupChoices,g=(0,r.useState)(x),k=g[0],N=g[1],w=[],D=(0,d.useScrollPositionBlocker)().blockElementScrollPositionUntilNextRender;if(null!=s){var O=v[s];null!=O&&O!==k&&f.some((function(e){return e.value===O}))&&N(O)}var P=function(e){var n=e.currentTarget,t=w.indexOf(n),r=f[t].value;r!==k&&(D(n),N(r),null!=s&&y(s,r))},C=function(e){var n,t=null;switch(e.key){case"ArrowRight":var r=w.indexOf(e.currentTarget)+1;t=w[r]||w[0];break;case"ArrowLeft":var a=w.indexOf(e.currentTarget)-1;t=w[a]||w[w.length-1]}null===(n=t)||void 0===n||n.focus()};return r.default.createElement("div",{className:"tabs-container"},r.default.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,a.default)("flex overflow-x-auto !p-0 m-0 font-bold text-light-text dark:text-dark-text",m)},f.map((function(e){var n=e.value,t=e.label;return r.default.createElement("li",{role:"tab",tabIndex:k===n?0:-1,"aria-selected":k===n,className:(0,a.default)("inline-flex break-words p-2 !m-0 border-b-4 border-transparent rounded-lg transition-[background-color] hover:bg-light-nonepress-100 dark:hover:bg-dark-nonepress-100",{"text-light-text-active dark:text-dark-text-active border-b-light-text-active dark:border-b-dark-text-active !rounded-b-none":k===n}),key:n,ref:function(e){return w.push(e)},onKeyDown:C,onFocus:P,onClick:P},null!=t?t:n)}))),p?(0,r.cloneElement)(c.filter((function(e){return e.props.value===k}))[0],{className:"my-4"}):r.default.createElement("div",{className:"my-4"},c.map((function(e,n){return(0,r.cloneElement)(e,{key:n,hidden:e.props.value!==k})}))))}var m=function(e){var n=(0,o.default)();return r.default.createElement(s,u({key:String(n)},e))};n.Z=m},90061:function(e,n,t){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=(0,t(27378).createContext)(void 0);n.default=r},3009:function(e,n,t){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r,a=t(27378),o=(r=t(90061))&&r.__esModule?r:{default:r};var l=function(){var e=(0,a.useContext)(o.default);if(null==e)throw new Error('"useUserPreferencesContext" is used outside of "Layout" component.');return e};n.default=l},67728:function(e,n,t){t.r(n),t.d(n,{frontMatter:function(){return i},contentTitle:function(){return u},metadata:function(){return s},toc:function(){return m},default:function(){return f}});var r=t(25773),a=t(30808),o=(t(27378),t(35318)),l=t(88473),d=t(85893),p=["components"],i={sidebar_position:3,description:"\u90e8\u7f72\u4f60\u7684\u673a\u5668\u4eba"},u="\u90e8\u7f72",s={unversionedId:"best-practice/deployment",id:"version-2.0.0/best-practice/deployment",isDocsHomePage:!1,title:"\u90e8\u7f72",description:"\u90e8\u7f72\u4f60\u7684\u673a\u5668\u4eba",source:"@site/versioned_docs/version-2.0.0/best-practice/deployment.mdx",sourceDirName:"best-practice",slug:"/best-practice/deployment",permalink:"/website/docs/2.0.0/best-practice/deployment",editUrl:"https://github.com/nonebot/nonebot2/edit/master/website/versioned_docs/version-2.0.0/best-practice/deployment.mdx",tags:[],version:"2.0.0",lastUpdatedBy:"noneflow[bot]",lastUpdatedAt:1694317549,formattedLastUpdatedAt:"2023/9/10",sidebarPosition:3,frontMatter:{sidebar_position:3,description:"\u90e8\u7f72\u4f60\u7684\u673a\u5668\u4eba"},sidebar:"version-2.0.0/tutorial",previous:{title:"\u9519\u8bef\u8ddf\u8e2a",permalink:"/website/docs/2.0.0/best-practice/error-tracking"},next:{title:"\u63d2\u4ef6\u8de8\u5e73\u53f0\u652f\u6301",permalink:"/website/docs/2.0.0/best-practice/multi-adapter"}},m=[{value:"\u90e8\u7f72\u524d\u51c6\u5907",id:"\u90e8\u7f72\u524d\u51c6\u5907",children:[{value:"\u9879\u76ee\u4f9d\u8d56\u7ba1\u7406",id:"\u9879\u76ee\u4f9d\u8d56\u7ba1\u7406",children:[],level:3},{value:"\u5b89\u88c5 Docker",id:"\u5b89\u88c5-docker",children:[],level:3},{value:"\u5b89\u88c5\u811a\u624b\u67b6 Docker \u63d2\u4ef6",id:"\u5b89\u88c5\u811a\u624b\u67b6-docker-\u63d2\u4ef6",children:[],level:3}],level:2},{value:"Docker \u90e8\u7f72",id:"docker-\u90e8\u7f72",children:[{value:"\u5feb\u901f\u90e8\u7f72",id:"\u5feb\u901f\u90e8\u7f72",children:[],level:3},{value:"\u81ea\u5b9a\u4e49\u90e8\u7f72",id:"\u81ea\u5b9a\u4e49\u90e8\u7f72",children:[],level:3},{value:"\u6301\u7eed\u96c6\u6210",id:"\u6301\u7eed\u96c6\u6210",children:[],level:3},{value:"\u6301\u7eed\u90e8\u7f72",id:"\u6301\u7eed\u90e8\u7f72",children:[],level:3}],level:2}],c={toc:m};function f(e){var n=e.components,t=(0,a.Z)(e,p);return(0,o.mdx)("wrapper",(0,r.Z)({},c,t,{components:n,mdxType:"MDXLayout"}),(0,o.mdx)("h1",{id:"\u90e8\u7f72"},"\u90e8\u7f72"),(0,o.mdx)("p",null,"\u5728\u7f16\u5199\u5b8c\u6210\u5404\u7c7b\u63d2\u4ef6\u540e\uff0c\u6211\u4eec\u9700\u8981\u957f\u671f\u8fd0\u884c\u673a\u5668\u4eba\u6765\u4f7f\u5f97\u7528\u6237\u80fd\u591f\u6b63\u5e38\u4f7f\u7528\u3002\u901a\u5e38\uff0c\u6211\u4eec\u4f1a\u4f7f\u7528\u4e91\u670d\u52a1\u5668\u6765\u90e8\u7f72\u673a\u5668\u4eba\u3002"),(0,o.mdx)("p",null,"\u6211\u4eec\u5728\u5f00\u53d1\u63d2\u4ef6\u65f6\uff0c\u673a\u5668\u4eba\u8fd0\u884c\u7684\u73af\u5883\u79f0\u4e3a\u5f00\u53d1\u73af\u5883\uff1b\u800c\u5728\u90e8\u7f72\u540e\uff0c\u673a\u5668\u4eba\u8fd0\u884c\u7684\u73af\u5883\u79f0\u4e3a\u751f\u4ea7\u73af\u5883\u3002\u4e0e\u5f00\u53d1\u73af\u5883\u4e0d\u540c\u7684\u662f\uff0c\u5728\u751f\u4ea7\u73af\u5883\u4e2d\uff0c\u5f00\u53d1\u8005\u901a\u5e38\u4e0d\u80fd\u968f\u610f\u5730\u4fee\u6539/\u6dfb\u52a0/\u5220\u9664\u4ee3\u7801\uff0c\u5f00\u542f\u6216\u505c\u6b62\u670d\u52a1\u3002"),(0,o.mdx)("h2",{id:"\u90e8\u7f72\u524d\u51c6\u5907"},"\u90e8\u7f72\u524d\u51c6\u5907"),(0,o.mdx)("h3",{id:"\u9879\u76ee\u4f9d\u8d56\u7ba1\u7406"},"\u9879\u76ee\u4f9d\u8d56\u7ba1\u7406"),(0,o.mdx)("p",null,"\u7531\u4e8e\u90e8\u7f72\u540e\u7684\u673a\u5668\u4eba\u8fd0\u884c\u5728\u751f\u4ea7\u73af\u5883\u4e2d\uff0c\u56e0\u6b64\uff0c\u4e3a\u786e\u4fdd\u673a\u5668\u4eba\u80fd\u591f\u6b63\u5e38\u8fd0\u884c\uff0c\u6211\u4eec\u9700\u8981\u4fdd\u8bc1\u673a\u5668\u4eba\u7684\u8fd0\u884c\u73af\u5883\u4e0e\u5f00\u53d1\u73af\u5883\u4e00\u81f4\u3002\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u4ee5\u4e0b\u51e0\u79cd\u65b9\u5f0f\u6765\u8fdb\u884c\u4f9d\u8d56\u7ba1\u7406\uff1a"),(0,o.mdx)(l.Z,{groupId:"tool",mdxType:"Tabs"},(0,o.mdx)(d.Z,{value:"poetry",label:"Poetry",default:!0,mdxType:"TabItem"},(0,o.mdx)("p",null,(0,o.mdx)("a",{parentName:"p",href:"https://python-poetry.org/"},"Poetry")," \u662f\u4e00\u4e2a Python \u9879\u76ee\u7684\u4f9d\u8d56\u7ba1\u7406\u5de5\u5177\u3002\u5b83\u53ef\u4ee5\u901a\u8fc7\u58f0\u660e\u9879\u76ee\u6240\u4f9d\u8d56\u7684\u5e93\uff0c\u4e3a\u4f60\u7ba1\u7406\uff08\u5b89\u88c5/\u66f4\u65b0\uff09\u5b83\u4eec\u3002Poetry \u63d0\u4f9b\u4e86\u4e00\u4e2a ",(0,o.mdx)("inlineCode",{parentName:"p"},"poetry.lock")," \u6587\u4ef6\uff0c\u4ee5\u786e\u4fdd\u53ef\u91cd\u590d\u5b89\u88c5\uff0c\u5e76\u53ef\u4ee5\u6784\u5efa\u7528\u4e8e\u5206\u53d1\u7684\u9879\u76ee\u3002"),(0,o.mdx)("p",null,"Poetry \u4f1a\u5728\u5b89\u88c5\u4f9d\u8d56\u65f6\u81ea\u52a8\u751f\u6210 ",(0,o.mdx)("inlineCode",{parentName:"p"},"poetry.lock")," \u6587\u4ef6\uff0c\u5728",(0,o.mdx)("strong",{parentName:"p"},"\u9879\u76ee\u76ee\u5f55"),"\u4e0b\u6267\u884c\u4ee5\u4e0b\u547d\u4ee4\uff1a"),(0,o.mdx)("pre",null,(0,o.mdx)("code",{parentName:"pre",className:"language-bash"},"# \u521d\u59cb\u5316 poetry \u914d\u7f6e\npoetry init\n# \u6dfb\u52a0\u9879\u76ee\u4f9d\u8d56\uff0c\u8fd9\u91cc\u4ee5 nonebot2[fastapi] \u4e3a\u4f8b\npoetry add nonebot2[fastapi]\n"))),(0,o.mdx)(d.Z,{value:"pdm",label:"PDM",mdxType:"TabItem"},(0,o.mdx)("p",null,(0,o.mdx)("a",{parentName:"p",href:"https://pdm.fming.dev/"},"PDM")," \u662f\u4e00\u4e2a\u73b0\u4ee3 Python \u9879\u76ee\u7684\u4f9d\u8d56\u7ba1\u7406\u5de5\u5177\u3002\u5b83\u91c7\u7528 ",(0,o.mdx)("a",{parentName:"p",href:"https://www.python.org/dev/peps/pep-0621/"},"PEP621")," \u6807\u51c6\uff0c\u4f9d\u8d56\u89e3\u6790\u5feb\u901f\uff1b\u540c\u65f6\u652f\u6301 ",(0,o.mdx)("a",{parentName:"p",href:"https://www.python.org/dev/peps/pep-0582/"},"PEP582")," \u548c ",(0,o.mdx)("a",{parentName:"p",href:"https://virtualenv.pypa.io/"},"virtualenv"),"\u3002PDM \u63d0\u4f9b\u4e86\u4e00\u4e2a ",(0,o.mdx)("inlineCode",{parentName:"p"},"pdm.lock")," \u6587\u4ef6\uff0c\u4ee5\u786e\u4fdd\u53ef\u91cd\u590d\u5b89\u88c5\uff0c\u5e76\u53ef\u4ee5\u6784\u5efa\u7528\u4e8e\u5206\u53d1\u7684\u9879\u76ee\u3002"),(0,o.mdx)("p",null,"PDM \u4f1a\u5728\u5b89\u88c5\u4f9d\u8d56\u65f6\u81ea\u52a8\u751f\u6210 ",(0,o.mdx)("inlineCode",{parentName:"p"},"pdm.lock")," \u6587\u4ef6\uff0c\u5728",(0,o.mdx)("strong",{parentName:"p"},"\u9879\u76ee\u76ee\u5f55"),"\u4e0b\u6267\u884c\u4ee5\u4e0b\u547d\u4ee4\uff1a"),(0,o.mdx)("pre",null,(0,o.mdx)("code",{parentName:"pre",className:"language-bash"},"# \u521d\u59cb\u5316 pdm \u914d\u7f6e\npdm init\n# \u6dfb\u52a0\u9879\u76ee\u4f9d\u8d56\uff0c\u8fd9\u91cc\u4ee5 nonebot2[fastapi] \u4e3a\u4f8b\npdm add nonebot2[fastapi]\n"))),(0,o.mdx)(d.Z,{value:"pip",label:"pip",mdxType:"TabItem"},(0,o.mdx)("p",null,(0,o.mdx)("a",{parentName:"p",href:"https://pip.pypa.io/"},"pip")," \u662f Python \u5305\u7ba1\u7406\u5de5\u5177\u3002\u4ed6\u5e76\u4e0d\u662f\u4e00\u4e2a\u4f9d\u8d56\u7ba1\u7406\u5de5\u5177\uff0c\u4e3a\u4e86\u5c3d\u53ef\u80fd\u4fdd\u8bc1\u73af\u5883\u7684\u4e00\u81f4\u6027\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528 ",(0,o.mdx)("inlineCode",{parentName:"p"},"requirements.txt")," \u6587\u4ef6\u6765\u58f0\u660e\u4f9d\u8d56\u3002"),(0,o.mdx)("pre",null,(0,o.mdx)("code",{parentName:"pre",className:"language-bash"},"pip freeze > requirements.txt\n")))),(0,o.mdx)("h3",{id:"\u5b89\u88c5-docker"},"\u5b89\u88c5 Docker"),(0,o.mdx)("p",null,(0,o.mdx)("a",{parentName:"p",href:"https://www.docker.com/"},"Docker")," \u662f\u4e00\u4e2a\u5e94\u7528\u5bb9\u5668\u5f15\u64ce\uff0c\u53ef\u4ee5\u8ba9\u5f00\u53d1\u8005\u6253\u5305\u5e94\u7528\u4ee5\u53ca\u4f9d\u8d56\u5305\u5230\u4e00\u4e2a\u53ef\u79fb\u690d\u7684\u955c\u50cf\u4e2d\uff0c\u7136\u540e\u53d1\u5e03\u5230\u670d\u52a1\u5668\u4e0a\u3002"),(0,o.mdx)("p",null,"\u6211\u4eec\u53ef\u4ee5\u53c2\u8003 ",(0,o.mdx)("a",{parentName:"p",href:"https://docs.docker.com/get-docker/"},"Docker \u5b98\u65b9\u6587\u6863")," \u6765\u5b89\u88c5 Docker \u3002"),(0,o.mdx)("p",null,"\u5728 Linux \u4e0a\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u4e00\u952e\u811a\u672c\u6765\u5b89\u88c5 Docker \u4ee5\u53ca Docker Compose Plugin\uff1a"),(0,o.mdx)("pre",null,(0,o.mdx)("code",{parentName:"pre",className:"language-bash"},"curl -fsSL https://get.docker.com | sh -s -- --mirror Aliyun\n")),(0,o.mdx)("p",null,"\u5728 Windows/macOS \u4e0a\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528 ",(0,o.mdx)("a",{parentName:"p",href:"https://docs.docker.com/desktop/"},"Docker Desktop")," \u6765\u5b89\u88c5 Docker \u4ee5\u53ca Docker Compose Plugin\u3002"),(0,o.mdx)("h3",{id:"\u5b89\u88c5\u811a\u624b\u67b6-docker-\u63d2\u4ef6"},"\u5b89\u88c5\u811a\u624b\u67b6 Docker \u63d2\u4ef6"),(0,o.mdx)("p",null,"\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528 ",(0,o.mdx)("a",{parentName:"p",href:"https://github.com/nonebot/cli-plugin-docker"},"nb-cli-plugin-docker")," \u6765\u5feb\u901f\u90e8\u7f72\u673a\u5668\u4eba\u3002"),(0,o.mdx)("p",null,"\u63d2\u4ef6\u53ef\u4ee5\u5e2e\u52a9\u6211\u4eec\u751f\u6210\u914d\u7f6e\u6587\u4ef6\u5e76\u6784\u5efa Docker \u955c\u50cf\uff0c\u4ee5\u53ca\u542f\u52a8/\u505c\u6b62/\u91cd\u542f\u673a\u5668\u4eba\u3002\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u5b89\u88c5\u811a\u624b\u67b6 Docker \u63d2\u4ef6\uff1a"),(0,o.mdx)("pre",null,(0,o.mdx)("code",{parentName:"pre",className:"language-bash"},"nb self install nb-cli-plugin-docker\n")),(0,o.mdx)("h2",{id:"docker-\u90e8\u7f72"},"Docker \u90e8\u7f72"),(0,o.mdx)("h3",{id:"\u5feb\u901f\u90e8\u7f72"},"\u5feb\u901f\u90e8\u7f72"),(0,o.mdx)("p",null,"\u4f7f\u7528\u811a\u624b\u67b6\u547d\u4ee4\u5373\u53ef\u4e00\u952e\u751f\u6210\u914d\u7f6e\u5e76\u90e8\u7f72\uff1a"),(0,o.mdx)("pre",null,(0,o.mdx)("code",{parentName:"pre",className:"language-bash"},"nb docker up\n")),(0,o.mdx)("p",null,"\u5f53\u770b\u5230 ",(0,o.mdx)("inlineCode",{parentName:"p"},"Running")," \u5b57\u6837\u65f6\uff0c\u8bf4\u660e\u673a\u5668\u4eba\u5df2\u7ecf\u542f\u52a8\u6210\u529f\u3002\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u4ee5\u4e0b\u547d\u4ee4\u6765\u67e5\u770b\u673a\u5668\u4eba\u7684\u8fd0\u884c\u65e5\u5fd7\uff1a"),(0,o.mdx)(l.Z,{groupId:"deploy-tool",mdxType:"Tabs"},(0,o.mdx)(d.Z,{value:"nb-cli",label:"NB CLI",default:!0,mdxType:"TabItem"},(0,o.mdx)("pre",null,(0,o.mdx)("code",{parentName:"pre",className:"language-bash"},"nb docker logs\n"))),(0,o.mdx)(d.Z,{value:"docker-compose",label:"Docker Compose",mdxType:"TabItem"},(0,o.mdx)("pre",null,(0,o.mdx)("code",{parentName:"pre",className:"language-bash"},"docker compose logs\n")))),(0,o.mdx)("p",null,"\u5982\u679c\u9700\u8981\u505c\u6b62\u673a\u5668\u4eba\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\uff1a"),(0,o.mdx)(l.Z,{groupId:"deploy-tool",mdxType:"Tabs"},(0,o.mdx)(d.Z,{value:"nb-cli",label:"NB CLI",default:!0,mdxType:"TabItem"},(0,o.mdx)("pre",null,(0,o.mdx)("code",{parentName:"pre",className:"language-bash"},"nb docker down\n"))),(0,o.mdx)(d.Z,{value:"docker-compose",label:"Docker Compose",mdxType:"TabItem"},(0,o.mdx)("pre",null,(0,o.mdx)("code",{parentName:"pre",className:"language-bash"},"docker compose down\n")))),(0,o.mdx)("h3",{id:"\u81ea\u5b9a\u4e49\u90e8\u7f72"},"\u81ea\u5b9a\u4e49\u90e8\u7f72"),(0,o.mdx)("p",null,"\u5728\u90e8\u5206\u60c5\u51b5\u4e0b\uff0c\u6211\u4eec\u9700\u8981\u4e8b\u5148\u751f\u6210 Docker \u914d\u7f6e\u6587\u4ef6\uff0c\u518d\u5230\u751f\u4ea7\u73af\u5883\u8fdb\u884c\u90e8\u7f72\uff1b\u6216\u8005\u81ea\u52a8\u751f\u6210\u7684\u914d\u7f6e\u6587\u4ef6\u5e76\u4e0d\u80fd\u6ee1\u8db3\u590d\u6742\u573a\u666f\uff0c\u9700\u8981\u6839\u636e\u5b9e\u9645\u9700\u6c42\u624b\u52a8\u4fee\u6539\u914d\u7f6e\u6587\u4ef6\u3002\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u6765\u751f\u6210\u57fa\u7840\u914d\u7f6e\u6587\u4ef6\uff1a"),(0,o.mdx)("pre",null,(0,o.mdx)("code",{parentName:"pre",className:"language-bash"},"nb docker generate\n")),(0,o.mdx)("p",null,"nb-cli \u5c06\u4f1a\u5728\u9879\u76ee\u76ee\u5f55\u4e0b\u751f\u6210 ",(0,o.mdx)("inlineCode",{parentName:"p"},"docker-compose.yml")," \u548c ",(0,o.mdx)("inlineCode",{parentName:"p"},"Dockerfile")," \u7b49\u914d\u7f6e\u6587\u4ef6\u3002\u5728 nb-cli \u5b8c\u6210\u914d\u7f6e\u6587\u4ef6\u7684\u751f\u6210\u540e\uff0c\u6211\u4eec\u53ef\u4ee5\u6839\u636e\u90e8\u7f72\u73af\u5883\u7684\u5b9e\u9645\u60c5\u51b5\u4f7f\u7528 nb-cli \u6216\u8005 Docker Compose \u6765\u542f\u52a8\u673a\u5668\u4eba\u3002"),(0,o.mdx)("p",null,"\u6211\u4eec\u53ef\u4ee5\u53c2\u8003 ",(0,o.mdx)("a",{parentName:"p",href:"https://docs.docker.com/engine/reference/builder/"},"Dockerfile \u6587\u4ef6\u89c4\u8303"),"\u548c ",(0,o.mdx)("a",{parentName:"p",href:"https://docs.docker.com/compose/compose-file/"},"Compose \u6587\u4ef6\u89c4\u8303"),"\u4fee\u6539\u8fd9\u4e24\u4e2a\u6587\u4ef6\u3002"),(0,o.mdx)("p",null,"\u4fee\u6539\u5b8c\u6210\u540e\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u542f\u52a8\u6216\u8005\u624b\u52a8\u6784\u5efa\u955c\u50cf\uff1a"),(0,o.mdx)(l.Z,{groupId:"deploy-tool",mdxType:"Tabs"},(0,o.mdx)(d.Z,{value:"nb-cli",label:"NB CLI",default:!0,mdxType:"TabItem"},(0,o.mdx)("pre",null,(0,o.mdx)("code",{parentName:"pre",className:"language-bash"},"# \u542f\u52a8\u673a\u5668\u4eba\nnb docker up\n# \u624b\u52a8\u6784\u5efa\u955c\u50cf\nnb docker build\n"))),(0,o.mdx)(d.Z,{value:"docker-compose",label:"Docker Compose",mdxType:"TabItem"},(0,o.mdx)("pre",null,(0,o.mdx)("code",{parentName:"pre",className:"language-bash"},"# \u542f\u52a8\u673a\u5668\u4eba\ndocker compose up -d\n# \u624b\u52a8\u6784\u5efa\u955c\u50cf\ndocker compose build\n")))),(0,o.mdx)("h3",{id:"\u6301\u7eed\u96c6\u6210"},"\u6301\u7eed\u96c6\u6210"),(0,o.mdx)("p",null,"\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528 GitHub Actions \u6765\u5b9e\u73b0\u6301\u7eed\u96c6\u6210\uff08CI\uff09\uff0c\u6211\u4eec\u53ea\u9700\u8981\u5728 GitHub \u4e0a\u53d1\u5e03 Release \u5373\u53ef\u81ea\u52a8\u6784\u5efa\u955c\u50cf\u5e76\u63a8\u9001\u81f3\u955c\u50cf\u4ed3\u5e93\u3002"),(0,o.mdx)("p",null,"\u9996\u5148\uff0c\u6211\u4eec\u9700\u8981\u5728 ",(0,o.mdx)("a",{parentName:"p",href:"https://hub.docker.com/"},"Docker Hub")," \uff08\u6216\u8005\u5176\u4ed6\u5e73\u53f0\uff0c\u5982\uff1a",(0,o.mdx)("a",{parentName:"p",href:"https://github.com/features/packages"},"GitHub Packages"),"\u3001",(0,o.mdx)("a",{parentName:"p",href:"https://www.alibabacloud.com/zh/product/container-registry"},"\u963f\u91cc\u4e91\u5bb9\u5668\u955c\u50cf\u670d\u52a1"),"\u7b49\uff09\u4e0a\u521b\u5efa\u955c\u50cf\u4ed3\u5e93\uff0c\u7528\u4e8e\u5b58\u653e\u955c\u50cf\u3002"),(0,o.mdx)("p",null,"\u524d\u5f80\u9879\u76ee\u4ed3\u5e93\u7684 ",(0,o.mdx)("inlineCode",{parentName:"p"},"Settings")," > ",(0,o.mdx)("inlineCode",{parentName:"p"},"Secrets")," > ",(0,o.mdx)("inlineCode",{parentName:"p"},"actions")," \u680f\u76ee ",(0,o.mdx)("inlineCode",{parentName:"p"},"New Repository Secret")," \u6dfb\u52a0\u6784\u5efa\u6240\u9700\u7684\u5bc6\u94a5\uff1a"),(0,o.mdx)("ul",null,(0,o.mdx)("li",{parentName:"ul"},(0,o.mdx)("inlineCode",{parentName:"li"},"DOCKERHUB_USERNAME"),": \u4f60\u7684 Docker Hub \u7528\u6237\u540d"),(0,o.mdx)("li",{parentName:"ul"},(0,o.mdx)("inlineCode",{parentName:"li"},"DOCKERHUB_TOKEN"),": \u4f60\u7684 Docker Hub PAT\uff08",(0,o.mdx)("a",{parentName:"li",href:"https://docs.docker.com/docker-hub/access-tokens/"},"\u521b\u5efa\u65b9\u6cd5"),"\uff09")),(0,o.mdx)("p",null,"\u5c06\u4ee5\u4e0b\u6587\u4ef6\u6dfb\u52a0\u81f3",(0,o.mdx)("strong",{parentName:"p"},"\u9879\u76ee\u76ee\u5f55"),"\u4e0b\u7684 ",(0,o.mdx)("inlineCode",{parentName:"p"},".github/workflows/")," \u76ee\u5f55\u4e0b\uff0c\u5e76\u5c06\u6587\u4ef6\u4e2d\u9ad8\u4eae\u884c\u4e2d\u7684\u4ed3\u5e93\u540d\u79f0\u66ff\u6362\u4e3a\u4f60\u7684\u4ed3\u5e93\u540d\u79f0\uff1a"),(0,o.mdx)("pre",null,(0,o.mdx)("code",{parentName:"pre",className:"language-yaml",metastring:"title=.github/workflows/build.yml {34}",title:".github/workflows/build.yml","{34}":!0},'name: Docker Hub Release\n\non:\n  push:\n    tags:\n      - "v*"\n\njobs:\n  docker:\n    runs-on: ubuntu-latest\n\n    steps:\n      - name: Checkout\n        uses: actions/checkout@v3\n\n      - name: Set up QEMU\n        uses: docker/setup-qemu-action@v2\n\n      - name: Setup Docker\n        uses: docker/setup-buildx-action@v2\n\n      - name: Login to DockerHub\n        uses: docker/login-action@v2\n        with:\n          username: ${{ secrets.DOCKERHUB_USERNAME }}\n          password: ${{ secrets.DOCKERHUB_TOKEN }}\n\n      - name: Generate Tags\n        uses: docker/metadata-action@v4\n        id: metadata\n        with:\n          images: |\n            {organization}/{repository}\n          tags: |\n            type=semver,pattern={{version}}\n            type=semver,pattern={{major}}.{{minor}}\n            type=sha\n\n      - name: Build and Publish\n        uses: docker/build-push-action@v4\n        with:\n          context: .\n          push: true\n          tags: ${{ steps.metadata.outputs.tags }}\n          labels: ${{ steps.metadata.outputs.labels }}\n          cache-from: type=gha\n          cache-to: type=gha,mode=max\n')),(0,o.mdx)("h3",{id:"\u6301\u7eed\u90e8\u7f72"},"\u6301\u7eed\u90e8\u7f72"),(0,o.mdx)("p",null,"\u5728\u5b8c\u6210\u53d1\u5e03\u5e76\u6784\u5efa\u955c\u50cf\u540e\uff0c\u6211\u4eec\u53ef\u4ee5\u81ea\u52a8\u5c06\u955c\u50cf\u90e8\u7f72\u5230\u670d\u52a1\u5668\u4e0a\u3002"),(0,o.mdx)("p",null,"\u524d\u5f80\u9879\u76ee\u4ed3\u5e93\u7684 ",(0,o.mdx)("inlineCode",{parentName:"p"},"Settings")," > ",(0,o.mdx)("inlineCode",{parentName:"p"},"Secrets")," > ",(0,o.mdx)("inlineCode",{parentName:"p"},"actions")," \u680f\u76ee ",(0,o.mdx)("inlineCode",{parentName:"p"},"New Repository Secret")," \u6dfb\u52a0\u90e8\u7f72\u6240\u9700\u7684\u5bc6\u94a5\uff1a"),(0,o.mdx)("ul",null,(0,o.mdx)("li",{parentName:"ul"},(0,o.mdx)("inlineCode",{parentName:"li"},"DEPLOY_HOST"),": \u90e8\u7f72\u670d\u52a1\u5668\u7684 SSH \u5730\u5740"),(0,o.mdx)("li",{parentName:"ul"},(0,o.mdx)("inlineCode",{parentName:"li"},"DEPLOY_USER"),": \u90e8\u7f72\u670d\u52a1\u5668\u7528\u6237\u540d"),(0,o.mdx)("li",{parentName:"ul"},(0,o.mdx)("inlineCode",{parentName:"li"},"DEPLOY_KEY"),": \u90e8\u7f72\u670d\u52a1\u5668\u79c1\u94a5\uff08",(0,o.mdx)("a",{parentName:"li",href:"https://github.com/appleboy/ssh-action#setting-up-a-ssh-key"},"\u521b\u5efa\u65b9\u6cd5"),"\uff09"),(0,o.mdx)("li",{parentName:"ul"},(0,o.mdx)("inlineCode",{parentName:"li"},"DEPLOY_PATH"),": \u90e8\u7f72\u670d\u52a1\u5668\u4e0a\u7684\u9879\u76ee\u8def\u5f84")),(0,o.mdx)("p",null,"\u5c06\u4ee5\u4e0b\u6587\u4ef6\u6dfb\u52a0\u81f3",(0,o.mdx)("strong",{parentName:"p"},"\u9879\u76ee\u76ee\u5f55"),"\u4e0b\u7684 ",(0,o.mdx)("inlineCode",{parentName:"p"},".github/workflows/")," \u76ee\u5f55\u4e0b\uff0c\u5728\u6784\u5efa\u6210\u529f\u540e\u89e6\u53d1\u90e8\u7f72\uff1a"),(0,o.mdx)("pre",null,(0,o.mdx)("code",{parentName:"pre",className:"language-yaml",metastring:"title=.github/workflows/deploy.yml",title:".github/workflows/deploy.yml"},"name: Deploy\n\non:\n  workflow_run:\n    workflows:\n      - Docker Hub Release\n    types:\n      - completed\n\njobs:\n  deploy:\n    runs-on: ubuntu-latest\n    if: ${{ github.event.workflow_run.conclusion == 'success' }}\n    steps:\n      - name: Start Deployment\n        uses: bobheadxi/deployments@v1\n        id: deployment\n        with:\n          step: start\n          token: ${{ secrets.GITHUB_TOKEN }}\n          env: bot\n\n      - name: Run Remote SSH Command\n        uses: appleboy/ssh-action@master\n        env:\n          DEPLOY_PATH: ${{ secrets.DEPLOY_PATH }}\n        with:\n          host: ${{ secrets.DEPLOY_HOST }}\n          username: ${{ secrets.DEPLOY_USER }}\n          key: ${{ secrets.DEPLOY_KEY }}\n          envs: DEPLOY_PATH\n          script: |\n            cd $DEPLOY_PATH\n            docker compose up -d --pull always\n\n      - name: update deployment status\n        uses: bobheadxi/deployments@v0.6.2\n        if: always()\n        with:\n          step: finish\n          token: ${{ secrets.GITHUB_TOKEN }}\n          status: ${{ job.status }}\n          env: ${{ steps.deployment.outputs.env }}\n          deployment_id: ${{ steps.deployment.outputs.deployment_id }}\n")),(0,o.mdx)("p",null,"\u5c06\u4e0a\u4e00\u90e8\u5206\u7684 ",(0,o.mdx)("inlineCode",{parentName:"p"},"docker-compose.yml")," \u6587\u4ef6\u4ee5\u53ca ",(0,o.mdx)("inlineCode",{parentName:"p"},".env.prod")," \u914d\u7f6e\u6587\u4ef6\u6dfb\u52a0\u81f3 ",(0,o.mdx)("inlineCode",{parentName:"p"},"DEPLOY_PATH")," \u76ee\u5f55\u4e0b\uff0c\u5e76\u4fee\u6539 ",(0,o.mdx)("inlineCode",{parentName:"p"},"docker-compose.yml")," \u6587\u4ef6\u4e2d\u7684\u955c\u50cf\u914d\u7f6e\uff0c\u66ff\u6362\u4e3a Docker Hub \u7684\u4ed3\u5e93\u540d\u79f0\uff1a"),(0,o.mdx)("pre",null,(0,o.mdx)("code",{parentName:"pre",className:"language-diff"},"- build: .\n+ image: {organization}/{repository}:latest\n")))}f.isMDXComponent=!0}}]);