version: '3'
services:
  app:
    image: stablelinuxccompiler
    working_dir: /var/task
    volumes:
      - ./elemental_engine/handlers/binaries:/var/task/elemental_engine/handlers/binaries
    command: sh -c "for file in /var/task/elemental_engine/handlers/binaries/*.c; do gcc -fPIC -shared $$file -o $${file%.c}.so -lm && clang -B. -MD -MF $${file%c} $$file -o $${file%.c}.out -lm; $${file%.c}.out; done"
