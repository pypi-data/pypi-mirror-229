import{b4 as I,aW as L,d as A,V as G,v as J,c as t,k as O,M as z,r as Q,E as q,aG as g,ai as H,b as d,e as a,w as o,o as n,u as s,b5 as K,g as c,j as v,b6 as X,b7 as R,N as Y,b8 as Z,n as ee,aL as ue,ab as te,t as oe}from"./index-af9a0126.js";import{u as se}from"./usePageTitle-f8d5ba55.js";function ae(){const w=[];return I(()=>w.forEach(l=>l.dismiss())),(...l)=>{const r=L(...l);return w.push(r),r}}const ne={class:"work-queue__upcoming-runs"},ce=A({__name:"WorkQueue",setup(w){const l=G(),r=J(),y=ae(),h=t(()=>{const u=["Upcoming Runs","Runs"];return O.xl||u.unshift("Details"),u}),C=z("workQueueId"),W=t(()=>`prefect agent start ${e.value?` --work-queue "${e.value.name}"`:""}`),k=Q([]),p=Q(),x=()=>{k.value=["Running","Pending"],p.value="Runs"},N={interval:3e5},_=q(r.workQueues.getWorkQueue,[C.value],N),e=t(()=>_.response),m=t(()=>{var u;return(u=e.value)==null?void 0:u.concurrencyLimit}),U=t(()=>{var u;return(u=e.value)==null?void 0:u.isPaused}),T=t(()=>!!(m.value&&m.value<=E.value&&!U.value)),b=t(()=>e.value?[e.value.name]:[]),{filter:F}=g({flowRuns:{workQueueName:b}}),P=()=>{l.push(te.workQueues())},V=t(()=>e.value?`Work Queue: ${e.value.name}`:"Work Queue"),{filter:B}=g({flowRuns:{state:{name:["Running","Pending"]},workQueueName:b.value}}),D=q(r.flowRuns.getFlowRunsCount,[B],{interval:3e4}),E=t(()=>D.response??0);return se(V),H(()=>{var u;return(u=e.value)==null?void 0:u.deprecated},u=>{u&&y(oe.info.deprecatedWorkQueue,"default",{dismissible:!1,timeout:!1})}),(u,i)=>{const M=d("p-button"),S=d("p-tabs"),$=d("p-layout-well"),j=d("p-layout-default");return n(),a(j,{class:"work-queue"},{header:o(()=>[e.value?(n(),a(s(K),{key:0,"work-queue":e.value,onUpdate:s(_).refresh,onDelete:P},null,8,["work-queue","onUpdate"])):c("",!0)]),default:o(()=>[v($,{class:"work-queue__body"},{header:o(()=>[v(s(X),{command:W.value,title:"Work queue is ready to go!",subtitle:"Work queues define the work to be done and agents poll a specific work queue for new work."},null,8,["command"])]),well:o(()=>[e.value?(n(),a(s(R),{key:0,alternate:"","work-queue":e.value},null,8,["work-queue"])):c("",!0)]),default:o(()=>[v(S,{selected:p.value,"onUpdate:selected":i[1]||(i[1]=f=>p.value=f),tabs:h.value},{details:o(()=>[e.value?(n(),a(s(R),{key:0,"work-queue":e.value},null,8,["work-queue"])):c("",!0)]),"upcoming-runs":o(()=>[Y("div",ne,[e.value?(n(),a(s(Z),{key:0,"work-queue":e.value},null,8,["work-queue"])):c("",!0),T.value?(n(),a(M,{key:1,class:"work-queue__active-runs-button",onClick:x},{default:o(()=>[ee(" Show active runs ")]),_:1})):c("",!0)])]),runs:o(()=>[v(s(ue),{states:k.value,"onUpdate:states":i[0]||(i[0]=f=>k.value=f),"flow-run-filter":s(F)},null,8,["states","flow-run-filter"])]),_:1},8,["selected","tabs"])]),_:1})]),_:1})}}});export{ce as default};
