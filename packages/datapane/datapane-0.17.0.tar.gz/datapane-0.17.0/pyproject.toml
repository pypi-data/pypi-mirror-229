[tool.poetry]
name = "datapane"
version = "0.17.0"
description = "Datapane client library and CLI tool"
authors = ["Datapane Team <dev@datapane.com>"]
license = "Apache-2.0"

readme = "README.md"
homepage = "https://www.datapane.com"
repository = "https://github.com/datapane/datapane"
documentation = "https://docs.datapane.com"


keywords = ["data", "analysis", "jupyter", "pandas", "altair"]
classifiers = [
    "Topic :: Software Development",
    "Topic :: Software Development :: Libraries :: Python Modules",
    "License :: OSI Approved :: Apache Software License",
    "Development Status :: 7 - Inactive",
    "Intended Audience :: Developers",
    "Environment :: Console",
    "Natural Language :: English",
    "Operating System :: OS Independent",
]

#packages = [
#    { include = "datapane", from = "src" }
#]

# extra files (allows overriding gitignore)
include = [
    "NOTICE",
    "README.md",
    "LICENSE",
    "src/datapane/_version.py",  # generated by devtools before build
    "src/datapane/resources/local_report/*",
    "src/datapane/resources/local_report/report/**/*",
]

[tool.poetry.dependencies]
python = ">=3.8.0, < 4.0.0"
#python = ">=3.8.0"

# DS
# numpy = "^1.21.2"
pandas = ">=1.4.0,<2.0.0"
pyarrow = ">=9.0.0"

# viz - only altair is required
altair = "^5.0.0"
vega-datasets = ">=0.9.0,<1.0.0"
matplotlib = { version = "^3.5.0", optional = true }
plotly = { version = "^5.6.0", optional = true }
bokeh = { version = "^2.3.0", optional = true }
folium = { version = ">=0.13.0, <0.15.0", optional = true }

# misc
chardet = ">=5.0.0,<6.0.0"
colorlog = "^6.4.0"
dominate = "^2.7.0"
importlib_resources = ">=5.6.0"
lxml = "^4.7.1"
micawber = ">=0.5.3"
packaging = ">=21.0.0,<24.0.0"
ipynbname = ">=2021.3.2"
multimethod = "^1.9.0"
typing-extensions = "^4.4.0"

[tool.poetry.extras]
plotting = ["matplotlib", "bokeh", "plotly", "folium"]
cloud = []

[tool.poetry.group.dev.dependencies]
pytest = "^7.0.0"
pytest-datadir = "^1.3.1"
pytest-timeout = "^2.0.1"
glom = ">=22.1.0,<24.0.0"
jupyterlab = "^3.0.0"
openpyxl = "^3.0.0"
pdoc3 = "^0.10.0"
mypy = ">=0.961.0"
types-chardet = "^5.0.1"
types-PyYAML = "^6.0.9"
types-click-spinner = "^0.1.12"
types-requests = "^2.28.0"
types-tabulate = ">=0.8.9, < 0.10.0"
pytest-dotenv = "^0.5.2"
# pinned, as this library is more targetted for use by pip
vendoring = "1.2.0"
# vendoring = { version = "1.2.0", python = ">=3.8.0, < 4.0.0" }

[tool.black]
# The same config should be duplicated in other pyproject.toml files so that
# black always finds it.
line-length = 120
target-version = ['py37']
include = '\.pyi?$'

[tool.ruff]
extend = "../pyproject.toml"
target-version = 'py38'

extend-ignore = [
    # Don't complain about not using X|Y or builtin collections for types
    # Ruff warns about this on py38 when using __future__.annotations
    "UP006",
    "UP007",
]

[tool.vendoring]  # https://github.com/pradyunsg/vendoring
# ref implementation: https://github.com/pypa/pip/blob/031d6ec3f81fd497eec63302fffe703b9707ac5e/pyproject.toml#L29
destination = "src/datapane/_vendor/"
requirements = "vendor.txt"
namespace = "datapane._vendor"

[tool.vendoring.transformations]
drop = [
    "bin/",
]
[tool.vendoring.typing-stubs]
# The generated .pyi files break autocomplete on PyCharm; drop them.
base64io = []
bottle = []

[tool.pyright]  # https://github.com/microsoft/pyright/blob/main/docs/configuration.md
# better vscode support, avoid using newer features in python
pythonVersion = "3.8"
# pyright defaults to "current", whereas we actually support all platforms
pythonPlatform = "All"

# FOR PEP-517/518
[build-system]
requires = ['poetry~=1.4.2']
build-backend = "poetry.core.masonry.api"
